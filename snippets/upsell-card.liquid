{%- comment -%}
  Attend un paramètre "variant".
  Ex: {% render 'upsell-card', variant: product.variants[0] %}
{%- endcomment -%}

{%- assign p = variant.product -%}
{%- assign img = variant.featured_image | default: p.featured_image -%}

<div class="upsell-card" style="
  border-radius: 8px;
  padding: 12px;
  text-align: center;
  max-width: 180px;
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
">
  <div>
    <img src="{{ img | image_url: width: 300 }}" alt="{{ p.title | escape }}" style="width: 100%; height: auto; object-fit: contain;">

    <div style="margin-top: 8px; font-weight: 600;">
      <div style="margin-top: 8px; font-weight: 600; display: flex; align-items: center; gap: 5px; justify-content: center; flex-direction: column;">
        <span style="font-size:14px;line-height:1.2;">{{ variant.title }}</span>
        <div style="display:flex; gap:5px;">
          <span style="font-size:13px;line-height:1;">{{ variant.price | money }}</span>
          {% if variant.compare_at_price > variant.price %}
            <span style="text-decoration: line-through; color: #999; font-size:13px; line-height:1;">
              {{ variant.compare_at_price | money | replace: '.00', '' }} 
            </span>
          {% endif %}
        </div>
      </div>
    </div>
  </div>

  {%- if variant.compare_at_price and variant.compare_at_price > variant.price -%}
  {%- assign savings = variant.compare_at_price | minus: variant.price -%}
  <div style="margin-top: 4px;">
    <span style="display: inline-block; background: #EB1478; color: white; font-weight: bold; font-size: 10px; padding: 4px 10px; border-radius: 16px;">
      Économisez {{ savings | money | replace_regex: '\.\d+', '' }}
    </span>
  </div>
{%- endif -%}

</div>


