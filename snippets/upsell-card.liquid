{%- comment -%}
  Attend un param√®tre "variant".
  Ex: {% render 'upsell-card', variant: product.variants[0] %}
{%- endcomment -%}

{%- assign p = variant.product -%}
{%- assign img = variant.featured_image | default: p.featured_image -%}

<div class="upsell-card" style="border-radius: 8px; padding: 12px; text-align: center; max-width: 180px;">
  {%- if img -%}
    <img
      src="{{ img | image_url: width: 300 }}"
      alt="{{ p.title | escape }}"
      style="width: 100%; height: auto; object-fit: contain;">
  {%- endif -%}

  <div style="margin-top: 8px; font-weight: 600;">
    <div style="margin-top: 8px; font-weight: 600; display: flex; align-items: center; gap: 5px; justify-content: center;">
      <span>{{ variant.price | money }}</span>

      {%- if variant.compare_at_price and variant.compare_at_price > variant.price -%}
        <span style="text-decoration: line-through; color: #999;">
          {{ variant.compare_at_price | money }}
        </span>
      {%- endif -%}
    </div>

    {%- if variant.compare_at_price and variant.compare_at_price > variant.price -%}
      {%- assign diff = variant.compare_at_price | minus: variant.price -%}
      {%- assign discount = 100.0 | times: diff | divided_by: variant.compare_at_price | round -%}
      <div style="margin-top: 4px;">
        <span style="display: inline-block; background: #0050d8; color: white; font-weight: bold; font-size: 0.75em; padding: 4px 10px; border-radius: 16px;">
          - {{ discount }}%
        </span>
      </div>
    {%- endif -%}
  </div>
</div>

